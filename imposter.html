<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Imposter Word Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --bg-soft: #0f172a;
      --card: #020617;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.15);
      --danger: #ef4444;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border: #1f2937;
      --radius-lg: 18px;
      --radius-md: 10px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .container {
      width: 100%;
      max-width: 560px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 26px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow:
        0 18px 50px rgba(15, 23, 42, 0.8),
        inset 0 0 0 1px rgba(15, 23, 42, 0.9);
      padding: 28px 24px 20px;
      backdrop-filter: blur(18px);
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
      gap: 12px;
    }

    h1 {
      font-size: 1.4rem;
      margin: 0;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .badge {
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
    }

    .subtitle {
      margin: 0 0 18px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .center {
      text-align: center;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      background: var(--accent);
      color: white;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        background 0.12s ease, opacity 0.15s ease;
      box-shadow: 0 8px 22px rgba(37, 99, 235, 0.35);
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 24px rgba(37, 99, 235, 0.5);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.4);
    }

    button.secondary {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: var(--text-main);
      box-shadow: none;
    }

    button.secondary:hover {
      background: rgba(15, 23, 42, 0.9);
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.8);
    }

    button.danger {
      background: var(--danger);
      box-shadow: 0 8px 22px rgba(248, 113, 113, 0.4);
    }

    button.danger:hover {
      box-shadow: 0 10px 24px rgba(248, 113, 113, 0.65);
    }

    button.small {
      padding: 7px 12px;
      font-size: 0.8rem;
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .start-card {
      border-radius: var(--radius-lg);
      border: 1px dashed rgba(148, 163, 184, 0.4);
      padding: 26px 20px 22px;
      text-align: center;
      background: linear-gradient(
        145deg,
        rgba(15, 23, 42, 0.95),
        rgba(15, 23, 42, 0.85)
      );
    }

    .start-big-button {
      margin-top: 12px;
      padding: 12px 28px;
      font-size: 0.95rem;
    }

    .muted {
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .pill-row {
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .pill {
      padding: 4px 10px;
      font-size: 0.72rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--text-muted);
    }

    .hidden {
      display: none !important;
    }

    .card {
      margin-top: 10px;
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at top left, #1e293b 0, #020617 50%);
      border: 1px solid rgba(148, 163, 184, 0.25);
      padding: 18px 18px 16px;
    }

    .game-header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .pill-soft {
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.78rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .pill-soft strong {
      font-weight: 600;
      color: var(--text-main);
    }

    .word-display {
      margin: 14px 0 10px;
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: radial-gradient(
        circle at top,
        rgba(37, 99, 235, 0.06) 0,
        rgba(15, 23, 42, 0.96) 55%
      );
      padding: 24px 18px 22px;
      text-align: center;
      min-height: 96px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .word-display span {
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .word-placeholder {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .word-display.revealed span {
      text-shadow: 0 0 22px rgba(59, 130, 246, 0.9);
    }

    .word-display.imposter span {
      color: #f97373;
      text-shadow:
        0 0 18px rgba(248, 113, 113, 0.8),
        0 0 32px rgba(248, 113, 113, 0.7);
    }

    .buttons-row {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .hint {
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-muted);
      min-height: 32px;
    }

    .top-row-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Modal */

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      visibility: hidden;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease, visibility 0.18s ease;
      z-index: 20;
    }

    .modal-backdrop.show {
      visibility: visible;
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      width: 100%;
      max-width: 520px;
      background: linear-gradient(
        145deg,
        rgba(15, 23, 42, 0.98),
        rgba(15, 23, 42, 0.94)
      );
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 20px 18px 16px;
      box-shadow:
        0 18px 55px rgba(15, 23, 42, 0.85),
        inset 0 0 0 1px rgba(15, 23, 42, 0.9);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .modal h2 {
      margin: 0;
      font-size: 1.05rem;
    }

    .modal-body {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    label {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: block;
      margin-bottom: 3px;
    }

    input,
    textarea {
      width: 100%;
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      padding: 8px 9px;
      font-size: 0.85rem;
      outline: none;
      resize: vertical;
      min-height: 38px;
    }

    textarea {
      min-height: 90px;
      max-height: 220px;
    }

    input:focus,
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.35);
    }

    .input-row {
      display: flex;
      gap: 10px;
    }

    .input-row .field {
      flex: 1;
    }

    .modal-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .error {
      color: #fca5a5;
      font-size: 0.78rem;
      min-height: 16px;
    }

    .tiny {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    @media (max-width: 560px) {
      .container {
        padding: 20px 16px 16px;
      }
      h1 {
        font-size: 1.2rem;
      }
      .word-display span {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Imposter Game</h1>
      <span class="badge">Party / One Device</span>
    </div>
    <p class="subtitle">
      Enter a list of secret words, then pass the device around. Some players
      see the word, imposters see only “IMPOSTER”.
    </p>

    <!-- START VIEW -->
    <div id="startView" class="start-card">
      <div class="center">
        <strong>Ready to set up a round?</strong>
        <p class="muted">
          You’ll choose the number of players, how many imposters, and paste in
          your word list.
        </p>
        <button id="startBtn" class="start-big-button">
          Start Game Setup
        </button>
        <div class="pill-row">
          <span class="pill">Pass &amp; reveal flow</span>
          <span class="pill">Random word each round</span>
          <span class="pill">Used words auto-removed</span>
        </div>
      </div>
    </div>

    <!-- GAME VIEW -->
    <div id="gameView" class="card hidden">
      <div class="game-header-row">
        <div>
          <div class="pill-soft" id="roundInfo">
            <span>Round <strong>1</strong></span>
          </div>
        </div>
        <div class="top-row-right">
          <span class="pill-soft" id="playersInfo"></span>
          <button id="resetBtn" class="secondary small" title="Back to setup">
            Reset
          </button>
        </div>
      </div>

      <div class="center" style="margin-bottom: 6px;">
        <div id="playerLabel" style="font-size: 0.9rem; font-weight: 600;">
          Player 1
        </div>
      </div>

      <div id="wordBox" class="word-display">
        <div class="word-placeholder">
          Pass the device to <strong>Player 1</strong>, then tap “Reveal”.
        </div>
      </div>

      <div class="buttons-row">
        <button id="revealBtn">Reveal</button>
        <button id="doneBtn" class="secondary hidden">Done</button>
        <button id="endRoundBtn" class="danger hidden">End Round</button>
      </div>

      <div id="hint" class="hint">
        Make sure only the current player can see the screen.
      </div>
    </div>
  </div>

  <!-- SETUP MODAL -->
  <div id="setupModal" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <h2>Game Setup</h2>
        <button id="closeSetupBtn" class="secondary small">Close</button>
      </div>

      <div class="modal-body">
        <div class="input-row">
          <div class="field">
            <label for="playerCountInput">Number of players</label>
            <input
              id="playerCountInput"
              type="number"
              min="2"
              step="1"
              value="6"
            />
          </div>
          <div class="field">
            <label for="imposterCountInput">Number of imposters</label>
            <input
              id="imposterCountInput"
              type="number"
              min="1"
              step="1"
              value="1"
            />
          </div>
        </div>

        <div>
          <label for="wordsInput">
            Words list
            <span class="tiny">
              (separate by commas or line breaks)
            </span>
          </label>
          <textarea
            id="wordsInput"
            placeholder="beach, concert, zoo&#10;library&#10;coffee shop"
          ></textarea>
        </div>
      </div>

      <div class="modal-footer">
        <div>
          <div id="errorText" class="error"></div>
          <div class="tiny">
            Example: <em>pizza, museum, space, jungle, office</em>
          </div>
        </div>
        <button id="goBtn">
          Go &amp; Start Round
        </button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Elements
      const startView = document.getElementById("startView");
      const startBtn = document.getElementById("startBtn");
      const gameView = document.getElementById("gameView");
      const resetBtn = document.getElementById("resetBtn");

      const roundInfo = document.getElementById("roundInfo");
      const playersInfo = document.getElementById("playersInfo");
      const playerLabel = document.getElementById("playerLabel");
      const wordBox = document.getElementById("wordBox");
      const hint = document.getElementById("hint");

      const revealBtn = document.getElementById("revealBtn");
      const doneBtn = document.getElementById("doneBtn");
      const endRoundBtn = document.getElementById("endRoundBtn");

      const setupModal = document.getElementById("setupModal");
      const closeSetupBtn = document.getElementById("closeSetupBtn");
      const goBtn = document.getElementById("goBtn");
      const playerCountInput = document.getElementById("playerCountInput");
      const imposterCountInput = document.getElementById("imposterCountInput");
      const wordsInput = document.getElementById("wordsInput");
      const errorText = document.getElementById("errorText");

      // Game state
      let wordsPool = [];
      let usedWords = [];
      let playersCount = 0;
      let impostersCount = 1;
      let roundNumber = 0;

      let currentWord = "";
      let currentPlayer = 1;
      let imposterSet = new Set();

      // Utilities
      function showSetupModal() {
        errorText.textContent = "";
        setupModal.classList.add("show");
      }

      function hideSetupModal() {
        setupModal.classList.remove("show");
      }

      function setStartMode() {
        gameView.classList.add("hidden");
        startView.classList.remove("hidden");
      }

      function setGameMode() {
        startView.classList.add("hidden");
        gameView.classList.remove("hidden");
      }

      function parseWords(raw) {
        return raw
          .split(/[\n,]+/g)
          .map((w) => w.trim())
          .filter((w) => w.length > 0);
      }

      function pickRandomWordFromPool() {
        if (wordsPool.length === 0) return null;
        const index = Math.floor(Math.random() * wordsPool.length);
        const word = wordsPool[index];
        // remove from pool
        wordsPool.splice(index, 1);
        usedWords.push(word);
        return word;
      }

      function pickImposters() {
        const availablePlayers = [];
        for (let i = 1; i <= playersCount; i++) {
          availablePlayers.push(i);
        }
        const chosen = new Set();
        for (let i = 0; i < impostersCount; i++) {
          const idx = Math.floor(Math.random() * availablePlayers.length);
          const p = availablePlayers[idx];
          chosen.add(p);
          availablePlayers.splice(idx, 1);
        }
        return chosen;
      }

      function updateRoundInfo() {
        roundInfo.innerHTML = `Round <strong>${roundNumber}</strong>`;
        playersInfo.textContent = `${playersCount} players · ${impostersCount} imposter${
          impostersCount > 1 ? "s" : ""
        }`;
      }

      function renderPlaceholderForPlayer() {
        wordBox.classList.remove("revealed", "imposter");
        wordBox.innerHTML = `
          <div class="word-placeholder">
            Pass the device to <strong>Player ${currentPlayer}</strong>, then tap “Reveal”.
          </div>
        `;
        playerLabel.textContent = `Player ${currentPlayer}`;
        hint.textContent =
          "Make sure only this player can see the screen before you reveal.";
        revealBtn.classList.remove("hidden");
        doneBtn.classList.add("hidden");
        endRoundBtn.classList.add("hidden");
      }

      function startNewRound() {
        if (wordsPool.length === 0) {
          // No words left
          currentWord = "";
          wordBox.classList.remove("revealed", "imposter");
          wordBox.innerHTML = `
            <div class="word-placeholder">
              No words left in the list. Tap <strong>Reset</strong> to set up a new game.
            </div>
          `;
          playerLabel.textContent = "No more rounds";
          hint.textContent = "";
          revealBtn.disabled = true;
          doneBtn.disabled = true;
          endRoundBtn.disabled = true;
          return;
        }

        revealBtn.disabled = false;
        doneBtn.disabled = false;
        endRoundBtn.disabled = false;

        roundNumber += 1;
        currentWord = pickRandomWordFromPool();
        imposterSet = pickImposters();
        currentPlayer = 1;
        updateRoundInfo();
        renderPlaceholderForPlayer();
      }

      // Event handlers

      startBtn.addEventListener("click", showSetupModal);

      closeSetupBtn.addEventListener("click", hideSetupModal);

      resetBtn.addEventListener("click", function () {
        // Back to initial start state
        setStartMode();
        wordsPool = [];
        usedWords = [];
        playersCount = 0;
        impostersCount = 1;
        roundNumber = 0;
        currentWord = "";
        currentPlayer = 1;
        imposterSet.clear();
        // Also clear game area display
        wordBox.classList.remove("revealed", "imposter");
        wordBox.innerHTML = `
          <div class="word-placeholder">
            Pass the device to <strong>Player 1</strong>, then tap “Reveal”.
          </div>
        `;
        playerLabel.textContent = "Player 1";
        hint.textContent =
          "Make sure only the current player can see the screen.";
      });

      goBtn.addEventListener("click", function () {
        const pCount = parseInt(playerCountInput.value, 10);
        const iCount = parseInt(imposterCountInput.value, 10);
        const words = parseWords(wordsInput.value);

        // Validation
        if (!Number.isFinite(pCount) || pCount < 2) {
          errorText.textContent = "You need at least 2 players.";
          return;
        }
        if (!Number.isFinite(iCount) || iCount < 1) {
          errorText.textContent = "You need at least 1 imposter.";
          return;
        }
        if (iCount >= pCount) {
          errorText.textContent =
            "Imposters must be fewer than the total number of players.";
          return;
        }
        if (words.length === 0) {
          errorText.textContent = "Please enter at least one word.";
          return;
        }

        // Setup game state
        wordsPool = words.slice(); // copy
        usedWords = [];
        playersCount = pCount;
        impostersCount = iCount;
        roundNumber = 0;
        errorText.textContent = "";

        hideSetupModal();
        setGameMode();
        startNewRound();
      });

      revealBtn.addEventListener("click", function () {
        const isImposter = imposterSet.has(currentPlayer);
        wordBox.classList.add("revealed");
        wordBox.classList.toggle("imposter", isImposter);

        const text = isImposter ? "IMPOSTER" : currentWord;
        wordBox.innerHTML = `<span>${text}</span>`;

        hint.textContent =
          "Remember your role. When you’re ready, tap “Done” and pass the device on.";
        revealBtn.classList.add("hidden");
        doneBtn.classList.remove("hidden");
      });

      doneBtn.addEventListener("click", function () {
        if (currentPlayer < playersCount) {
          currentPlayer += 1;
          renderPlaceholderForPlayer();
        } else {
          // All players done
          wordBox.classList.remove("imposter");
          wordBox.classList.add("revealed");
          wordBox.innerHTML = `
            <div class="word-placeholder">
              All players have seen their roles. Time to talk and find the imposters!
            </div>
          `;
          playerLabel.textContent = "Discussion time";
          hint.textContent =
            "When the round is completely finished, tap “End Round” to draw a new word.";
          revealBtn.classList.add("hidden");
          doneBtn.classList.add("hidden");
          endRoundBtn.classList.remove("hidden");
        }
      });

      endRoundBtn.addEventListener("click", function () {
        startNewRound();
      });

      // Start in start mode
      setStartMode();
    })();
  </script>
</body>
</html>
